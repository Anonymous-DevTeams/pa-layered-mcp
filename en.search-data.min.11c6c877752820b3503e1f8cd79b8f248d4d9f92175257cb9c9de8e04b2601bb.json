[{"id":0,"href":"/en/docs/pa-layer/overview/","title":"Architecture Overview","section":"PA-Layer","content":"Architecture Overview# Core architecture principles and rules of PA-Layer.\nHexagonal Architecture (Port/Adapter)# Core Idea# Separate business logic from technical details.\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ REST â”€â”€â”€â”€â–ºâ”‚ Port â”‚ â”‚ â†“ â”‚ gRPC â”€â”€â”€â”€â–ºâ”‚ Domain Logic (Business Core)â”‚â—„â”€â”€â”€â”€ DB â”‚ â†“ â”‚ GraphQL â”€â”€â”€â”€â–ºâ”‚ Port â”‚â—„â”€â”€â”€â”€ Cache â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ Left: Driving Adapters (input) Right: Driven Adapters (output)Application in PA-Layer# We adopt only the core concepts of Hexagonal, not full implementation:\nOriginal Hexagonal PA-Layer Application Port (Interface) Port Document - Interface spec Adapter (Implementation) Code Implementation - Kotlin/TS/Go Driving/Driven distinction Simplified to input/output direction CQS (Command-Query Separation)# Principle# Command Query Changes state Reads state Has side effects No side effects Usually no return or Result Returns data PA-Layer Application# 1 2 3 4 5 6 7 8 9 10 11 12 13 14 // âŒ Anti-pattern: Mixed Command and Query interface UserPort { fun createUser(request: CreateUserRequest): User // Creates and returns } // âœ… Recommended: Separated interface UserCommandPort { suspend fun createUser(command: CreateUserCommand): CreateUserResult } interface UserQueryPort { suspend fun findUser(query: FindUserQuery): User? suspend fun listUsers(query: ListUsersQuery): List\u0026lt;User\u0026gt; } Layer Rules# Dependency Direction# Upper Layer â†’ Lower Layer (unidirectional) API â†“ L2 â†“ LM (optional) â†“ L1Rules:\nL1 cannot depend on other L1 L2 depends on L1 or LM LM depends only on L1 API depends on L2 L1 (Domain Layer)# Single domain responsibility Pure business logic Minimal external dependencies L2 (Feature Layer)# Combines multiple L1 Ports User feature unit Transaction boundary management LM (Mediator Layer) - Optional# Coordinates between L1 Ports Complex inter-domain interactions Use only when needed Document Conventions# Frontmatter Required Fields# 1 2 3 4 5 6 --- type: l2 # Required: Document type domain: auth # Recommended: Domain status: active # Optional: draft, active, deprecated depends_on: [] # Optional: Dependent documents --- Next Steps# Backend Conventions Frontend Conventions "},{"id":1,"href":"/en/docs/pa-retriever/basic/","title":"Basic Usage","section":"PA-Retriever","content":"Basic Usage# Basic commands and workflows for PA-Retriever.\nQuick Start# 1 2 3 4 5 6 7 8 9 10 11 # 1. Initialize pa init # 2. Index documents pa index # 3. Test search pa search \u0026#34;type:l2\u0026#34; # 4. Connect Claude pa mcp install Main Commands# Initialize (init)# 1 2 3 4 5 6 7 8 # Interactive initialization (recommended) pa init # Quick initialization with defaults pa init --yes # Re-initialize with clean slate pa init --clear Index (index)# 1 2 3 4 5 6 7 8 # Basic indexing (changed files only) pa index # Full re-indexing pa index --force # Verbose output pa index --verbose Output example:\nğŸ“š Indexing: /Users/user/playground/mcp-docs Processing: âœ“ ports/auth/L1-AuthPort.md âœ“ ports/auth/L2-LoginPort.md ... ğŸ“Š Complete: Total files: 47 New: 3 Updated: 2 Total tokens: 45,230Status (status)# 1 2 3 4 5 # Full dashboard pa status # Compact output pa status --compact Search (search)# 1 2 3 4 5 6 7 8 9 10 11 # Basic search pa search \u0026#34;login\u0026#34; # Type filter pa search \u0026#34;type:l2\u0026#34; # Complex query pa search \u0026#34;type:l2 AND domain:auth\u0026#34; # JSON output pa search \u0026#34;login\u0026#34; --json Version (version)# 1 pa version Common Workflows# Adding New Documents# 1 2 3 4 5 6 7 8 # 1. Create document in Obsidian # ports/orders/L2-CheckoutPort.md # 2. Index pa index # 3. Verify search pa search \u0026#34;L2-CheckoutPort\u0026#34; Switching Profiles# 1 2 3 4 5 6 7 8 # List profiles pa profile list # Switch to work profile pa use work # Check current profile pa status --compact Next Steps# Search Guide - Advanced queries Using with Claude - MCP integration "},{"id":2,"href":"/en/docs/configuration/claude/","title":"Claude Integration","section":"Configuration","content":"Claude Integration# Connect PA-Retriever with Claude Desktop and Claude Code.\nMCP (Model Context Protocol)# MCP is the protocol that Claude uses to communicate with external tools. PA-Retriever operates as an MCP server to provide document search/retrieval capabilities to Claude.\nAuto Setup# 1 2 3 4 5 6 7 8 9 10 11 # Auto-configure all clients pa mcp install # Claude Desktop only pa mcp install --desktop # Claude Code only pa mcp install --code # Check status pa mcp status Manual Setup# Claude Desktop (macOS)# Config file location:\n~/Library/Application Support/Claude/claude_desktop_config.jsonContent:\n1 2 3 4 5 6 7 8 { \u0026#34;mcpServers\u0026#34;: { \u0026#34;pa-retriever\u0026#34;: { \u0026#34;command\u0026#34;: \u0026#34;/usr/local/bin/pa\u0026#34;, \u0026#34;args\u0026#34;: [\u0026#34;serve\u0026#34;, \u0026#34;--mcp\u0026#34;] } } } Claude Desktop (Windows)# Config file location:\n%APPDATA%\\Claude\\claude_desktop_config.jsonContent:\n1 2 3 4 5 6 7 8 { \u0026#34;mcpServers\u0026#34;: { \u0026#34;pa-retriever\u0026#34;: { \u0026#34;command\u0026#34;: \u0026#34;C:\\\\Users\\\\\u0026lt;username\u0026gt;\\\\.local\\\\bin\\\\pa.exe\u0026#34;, \u0026#34;args\u0026#34;: [\u0026#34;serve\u0026#34;, \u0026#34;--mcp\u0026#34;] } } } Verify Connection# 1. Restart Claude Desktop# After configuration, completely quit and restart Claude Desktop.\n2. Check MCP Tools# In a conversation with Claude:\n\u0026#34;Tell me the available tools from PA-Retriever\u0026#34;Expected response:\nThe following tools are available from PA-Retriever MCP server: 1. search_docs - Search documents 2. get_doc - Get document 3. find_port - Find Port 4. get_architecture - Architecture rules 5. list_by_type - List by type 6. get_stats - Statistics3. Test Search# \u0026#34;Search for all L2 Ports in the auth domain\u0026#34;Claude will call PA-Retriever and return results.\nNext Steps# Obsidian Settings PA-Retriever Config "},{"id":3,"href":"/en/docs/","title":"Documentation","section":"PA-Layer","content":"PA-Layer Documentation# A comprehensive guide to installation, configuration, and architecture conventions for the PA-Layer system.\nTable of Contents# Installation\nPlatform-specific installation guides Workspace setup Required tools configuration Configuration\nClaude integration Obsidian settings PA-Retriever configuration PA-Layer\nArchitecture overview Backend conventions Frontend conventions PA-Retriever\nBasic usage Advanced features Using with Claude "},{"id":4,"href":"/en/docs/installation/","title":"Installation","section":"Documentation","content":"Installation# Environment setup guide for using the PA-Layer system.\nRequirements# Tool Version Purpose Claude Desktop Latest AI Agent Obsidian 1.4+ Document Editor pa-retriever 0.8+ Document Indexer \u0026amp; MCP Server Recommended# Tool Purpose VS Code Code Editor Claude Code AI Coding Agent Git Version Control Platform-specific Installation# macOS Installation Windows Installation Linux Installation Workspace Setup "},{"id":5,"href":"/en/docs/installation/macos/","title":"macOS Installation","section":"Installation","content":"macOS Installation Guide# Set up the PA-Layer environment on Apple Silicon (M1/M2/M3) and Intel Mac.\n1. Install with Homebrew (Recommended)# 1 2 3 4 5 6 7 8 9 # Install Homebrew (if not installed) /bin/bash -c \u0026#34;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)\u0026#34; # Install PA-Retriever brew tap pa-layer/tap brew install pa-retriever # Verify installation pa version 2. Manual Installation# Apple Silicon (M1/M2/M3)# 1 2 3 4 5 6 7 8 9 # Download curl -LO https://github.com/pa-layer/pa-retriever/releases/latest/download/pa-retriever-darwin-arm64.tar.gz # Extract tar xzf pa-retriever-darwin-arm64.tar.gz # Add to PATH chmod +x pa sudo mv pa /usr/local/bin/ Intel Mac# 1 2 3 4 5 6 7 # Download curl -LO https://github.com/pa-layer/pa-retriever/releases/latest/download/pa-retriever-darwin-amd64.tar.gz # Extract and install tar xzf pa-retriever-darwin-amd64.tar.gz chmod +x pa sudo mv pa /usr/local/bin/ 3. Install Required Tools# Claude Desktop# Download from claude.ai/download Move to Applications folder Launch and sign in Obsidian# 1 2 # Install with Homebrew brew install --cask obsidian 4. Shell Configuration# Zsh (~/.zshrc)# 1 2 3 4 5 6 7 8 # PA-Layer environment variables export PA_HOME=\u0026#34;$HOME/.pa\u0026#34; export PA_WORKSPACE=\u0026#34;$HOME/playground\u0026#34; # Aliases (optional) alias pas=\u0026#34;pa search\u0026#34; alias pai=\u0026#34;pa index\u0026#34; alias pac=\u0026#34;pa code\u0026#34; 5. Initialize# 1 2 3 4 5 # Interactive initialization (recommended) pa init # Quick initialization with defaults pa init --yes Next Steps# Workspace Setup - Directory structure setup Configuration - Claude integration "},{"id":6,"href":"/en/docs/pa-layer/backend/","title":"Backend Conventions","section":"PA-Layer","content":"Backend Conventions# PA-Layer Backend implementation guide.\nCommon Principles# Directory Structure# src/ â”œâ”€â”€ domain/ # By domain â”‚ â”œâ”€â”€ auth/ â”‚ â”‚ â”œâ”€â”€ port/ # Port interfaces â”‚ â”‚ â”œâ”€â”€ adapter/ # Adapter implementations â”‚ â”‚ â””â”€â”€ model/ # Domain models â”‚ â””â”€â”€ orders/ â”œâ”€â”€ api/ # API layer â””â”€â”€ infrastructure/ # InfrastructureNaming Rules# Type Rule Example L1 Port {Domain}Port UserPort, TokenPort L2 Port {Feature}Port LoginPort, CheckoutPort Adapter {Port}Adapter LoginAdapter Query {Domain}Query UserQuery Kotlin / Spring Framework# L1 Port Example# 1 2 3 4 5 6 7 8 9 interface UserPort { suspend fun create(command: CreateUserCommand): CreateUserResult suspend fun update(command: UpdateUserCommand): UpdateUserResult } sealed class CreateUserResult { data class Success(val userId: UserId) : CreateUserResult() data class EmailAlreadyExists(val email: String) : CreateUserResult() } L2 Port Example# 1 2 3 4 5 6 7 8 9 10 interface LoginPort { suspend fun login(request: LoginRequest): LoginResult suspend fun logout(request: LogoutRequest): LogoutResult } sealed class LoginResult { data class Success(val accessToken: String, val refreshToken: String) object InvalidCredentials object AccountLocked } Adapter Example# 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 @Component class LoginAdapter( private val userPort: UserPort, private val tokenPort: TokenPort ) : LoginPort { @Transactional override suspend fun login(request: LoginRequest): LoginResult { val user = userPort.findByEmail(request.email) ?: return LoginResult.InvalidCredentials if (!user.verifyPassword(request.password)) { return LoginResult.InvalidCredentials } val tokens = tokenPort.generate(user.id) return LoginResult.Success(tokens.accessToken, tokens.refreshToken) } } TypeScript / NestJS# Port Example# 1 2 3 4 5 6 7 8 9 10 11 export const LOGIN_PORT = Symbol(\u0026#39;LOGIN_PORT\u0026#39;); export interface LoginPort { login(request: LoginRequest): Promise\u0026lt;LoginResult\u0026gt;; logout(): Promise\u0026lt;void\u0026gt;; } export type LoginResult = | { type: \u0026#39;success\u0026#39;; accessToken: string; refreshToken: string } | { type: \u0026#39;invalidCredentials\u0026#39; } | { type: \u0026#39;accountLocked\u0026#39; }; Go# Port Example# 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 type LoginPort interface { Login(ctx context.Context, req LoginRequest) (LoginResult, error) Logout(ctx context.Context, req LogoutRequest) error } type LoginResult struct { Type string AccessToken string RefreshToken string } const ( LoginSuccess = \u0026#34;success\u0026#34; LoginInvalidCredentials = \u0026#34;invalid_credentials\u0026#34; ) Next Steps# Frontend Conventions "},{"id":7,"href":"/en/docs/configuration/","title":"Configuration","section":"Documentation","content":"Configuration# Configure integration between Claude, Obsidian, and PA-Retriever.\nOverview# â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” MCP â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ Claude â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ PA-Retriever â”‚ â”‚ Desktop â”‚ â”‚ MCP Server â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â–¼ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ Obsidian â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ mcp-docs/ â”‚ â”‚ (Editor) â”‚ Files â”‚ (Vault) â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜Sections# Claude Integration Obsidian Settings PA-Retriever Config "},{"id":8,"href":"/en/docs/configuration/obsidian/","title":"Obsidian Settings","section":"Configuration","content":"Obsidian Settings# Obsidian configuration for PA-Layer document authoring.\nOpen Vault# 1 2 3 4 5 6 # 1. Create mcp-docs directory (if not exists) mkdir -p ~/playground/mcp-docs # 2. Launch Obsidian # 3. Select \u0026#34;Open folder as vault\u0026#34; # 4. Select ~/playground/mcp-docs Recommended Plugins# Required# Plugin Purpose Templater Document template automation Dataview Document query/filtering Recommended# Plugin Purpose Git Git synchronization Excalidraw Diagrams Kanban Task boards Directory Structure# mcp-docs/ â”œâ”€â”€ .obsidian/ # Obsidian settings â”œâ”€â”€ templates/ # Templater templates â”‚ â”œâ”€â”€ tpl-l1-port.md â”‚ â”œâ”€â”€ tpl-l2-port.md â”‚ â””â”€â”€ tpl-api-port.md â”œâ”€â”€ ports/ # Port documents â”‚ â”œâ”€â”€ auth/ â”‚ â””â”€â”€ users/ â”œâ”€â”€ guides/ # Guide documents â””â”€â”€ .pa-index.yaml # PA-Retriever settingsTemplate Example# tpl-l2-port.md# 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 --- type: l2 domain: status: draft created: {{date}} --- # L2-{{title}} ## Overview \u0026gt; [!info] Port Summary \u0026gt; - **Purpose**: \u0026gt; - **Domain**: \u0026gt; - **Dependencies**: ## Interface ```kotlin interface {{title}} { // TODO: Define methods } Related Documents# [[]] ## Dataview Queries ### All L2 Ports ```dataview TABLE domain, status, updated FROM \u0026#34;\u0026#34; WHERE type = \u0026#34;l2\u0026#34; SORT domain, file.name Next Steps# PA-Retriever Config "},{"id":9,"href":"/en/docs/pa-retriever/search/","title":"Search Guide","section":"PA-Retriever","content":"Search Guide# Advanced search syntax for PA-Retriever.\nSearch Command# 1 2 3 4 5 6 pa search \u0026lt;query\u0026gt; [options] Options: --limit=N Limit results (default: 10) --json JSON output --content Include body content Basic Search# Keyword Search# 1 2 3 4 5 # Single keyword pa search \u0026#34;login\u0026#34; # Multiple keywords (implicit AND) pa search \u0026#34;login auth\u0026#34; Field Search# Syntax# field:valueSupported Fields# Field Description Example type Document type type:l2 domain Domain domain:auth status Status status:active priority Priority priority:high author Author author:john tag Tag tag:jwt Examples# 1 2 3 4 5 6 7 8 # L2 type only pa search \u0026#34;type:l2\u0026#34; # auth domain only pa search \u0026#34;domain:auth\u0026#34; # Specific tag pa search \u0026#34;tag:jwt\u0026#34; Complex Queries# AND Operation# 1 2 3 4 5 # Explicit AND pa search \u0026#34;type:l2 AND domain:auth\u0026#34; # Implicit AND (space) pa search \u0026#34;type:l2 domain:auth\u0026#34; OR Operation# 1 2 3 4 5 # L1 or L2 type pa search \u0026#34;type:l1 OR type:l2\u0026#34; # auth or users domain pa search \u0026#34;domain:auth OR domain:users\u0026#34; NOT Operation# 1 2 3 4 5 # Exclude deprecated pa search \u0026#34;type:l2 NOT status:deprecated\u0026#34; # Exclude drafts pa search \u0026#34;domain:auth NOT status:draft\u0026#34; Parentheses Grouping# 1 2 3 4 5 # (auth OR users) domain L2s pa search \u0026#34;type:l2 AND (domain:auth OR domain:users)\u0026#34; # Complex combination pa search \u0026#34;(type:l1 OR type:l2) AND domain:orders NOT status:draft\u0026#34; Range Search# Token Count# 1 2 3 4 5 # More than 1000 tokens pa search \u0026#34;tokens:\u0026gt;1000\u0026#34; # Less than 500 tokens pa search \u0026#34;tokens:\u0026lt;500\u0026#34; Full-text Search (FTS)# Content Search# 1 2 3 4 5 # Body contains \u0026#34;suspend fun\u0026#34; pa search \u0026#34;suspend fun\u0026#34; # Body contains \u0026#34;interface\u0026#34; pa search \u0026#34;interface\u0026#34; JSON Output# 1 2 3 4 5 6 7 8 # JSON format pa search \u0026#34;type:l2\u0026#34; --json # With jq pa search \u0026#34;type:l2\u0026#34; --json | jq \u0026#39;.[] | .id\u0026#39; # Save to file pa search \u0026#34;domain:auth\u0026#34; --json \u0026gt; auth-docs.json Next Steps# Code Indexing Using with Claude "},{"id":10,"href":"/en/docs/installation/windows/","title":"Windows Installation","section":"Installation","content":"Windows Installation Guide# Set up the PA-Layer environment on Windows 10/11.\n1. Install with Scoop (Recommended)# 1 2 3 4 5 6 7 8 9 10 # Install Scoop (if not installed) Set-ExecutionPolicy RemoteSigned -Scope CurrentUser irm get.scoop.sh | iex # Install PA-Retriever scoop bucket add pa-layer https://github.com/pa-layer/scoop-bucket scoop install pa-retriever # Verify installation pa version 2. Manual Installation# Download with PowerShell# 1 2 3 4 5 6 7 8 9 10 11 12 13 14 # Navigate to Downloads cd $HOME\\Downloads # Download Invoke-WebRequest -Uri \u0026#34;https://github.com/pa-layer/pa-retriever/releases/latest/download/pa-retriever-windows-amd64.zip\u0026#34; -OutFile \u0026#34;pa-retriever.zip\u0026#34; # Extract Expand-Archive -Path \u0026#34;pa-retriever.zip\u0026#34; -DestinationPath \u0026#34;pa-retriever\u0026#34; # Create install directory New-Item -ItemType Directory -Force -Path \u0026#34;$HOME\\.local\\bin\u0026#34; # Move binary Move-Item -Path \u0026#34;pa-retriever\\pa.exe\u0026#34; -Destination \u0026#34;$HOME\\.local\\bin\\pa.exe\u0026#34; Add to PATH# 1 2 3 4 5 6 $currentPath = [Environment]::GetEnvironmentVariable(\u0026#34;Path\u0026#34;, \u0026#34;User\u0026#34;) $newPath = \u0026#34;$HOME\\.local\\bin\u0026#34; if ($currentPath -notlike \u0026#34;*$newPath*\u0026#34;) { [Environment]::SetEnvironmentVariable(\u0026#34;Path\u0026#34;, \u0026#34;$currentPath;$newPath\u0026#34;, \u0026#34;User\u0026#34;) } 3. Install Required Tools# Claude Desktop# Download Windows version from claude.ai/download Run installer Sign in after installation Obsidian# 1 scoop install obsidian Git# 1 scoop install git 4. PowerShell Profile# Profile location# 1 2 $PROFILE # Usually: C:\\Users\\\u0026lt;username\u0026gt;\\Documents\\PowerShell\\Microsoft.PowerShell_profile.ps1 Profile settings# 1 2 3 4 5 6 7 8 # PA-Layer environment variables $env:PA_HOME = \u0026#34;$HOME\\.pa\u0026#34; $env:PA_WORKSPACE = \u0026#34;$HOME\\playground\u0026#34; # Shortcut functions function pas { pa search $args } function pai { pa index $args } function pac { pa code $args } 5. Initialize# 1 2 3 4 5 # Interactive initialization pa init # Quick initialization pa init --yes Next Steps# Workspace Setup Configuration "},{"id":11,"href":"/en/docs/pa-retriever/code/","title":"Code Indexing","section":"PA-Retriever","content":"Code Indexing# PA-Retriever code signature indexing feature.\nOverview# Code indexing extracts Port signatures from actual code and connects them to documents.\nDocument (Port Spec) Code (Implementation) â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ L2-LoginPort â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ LoginPort.kt â”‚ â”‚ (Markdown) â”‚ Connect â”‚ (Kotlin) â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜Supported Languages# Language Extensions Extracts Kotlin .kt interface, class, fun, suspend fun TypeScript .ts, .tsx interface, class, function, type Go .go type, func, interface Commands# Register Project# 1 2 3 4 5 6 7 # Add project pa code add \u0026lt;name\u0026gt; \u0026lt;path\u0026gt; [options] # Examples pa code add my-backend ~/playground/CodeSpace/my-backend --lang=kotlin pa code add my-frontend ~/playground/CodeSpace/my-frontend --lang=typescript pa code add my-api ~/playground/CodeSpace/my-api --lang=go List Projects# 1 pa code list Output:\nğŸ“¦ Registered Code Projects my-backend (kotlin) Path: ~/playground/CodeSpace/my-backend Signatures: 234 my-frontend (typescript) Path: ~/playground/CodeSpace/my-frontend Signatures: 156Index Code# 1 2 3 4 5 6 7 8 # Index all projects pa code index # Specific project only pa code index --project=my-backend # Force re-index pa code index --force Search Code# 1 2 3 4 5 6 7 # Search signatures pa code search \u0026lt;query\u0026gt; # Examples pa code search \u0026#34;LoginPort\u0026#34; pa code search \u0026#34;fun login\u0026#34; pa code search \u0026#34;interface User\u0026#34; Output:\nğŸ” Code Search: \u0026#34;LoginPort\u0026#34; (3 results) 1. [interface] LoginPort File: src/domain/auth/port/LoginPort.kt Project: my-backend Linked Doc: auth.L2-LoginPort âœ“ 2. [class] LoginAdapter File: src/application/adapter/LoginAdapter.kt Project: my-backend Implements: LoginPortDocument-Code Connection# Automatic Connection# PA-Retriever attempts automatic connection using:\nName matching: Document ID and signature name Marker matching: @pa-port marker Using Markers# Add marker to document for explicit connection:\n1 2 3 4 5 6 7 8 9 \u0026lt;!-- L2-LoginPort.md --\u0026gt; --- type: l2 domain: auth --- # L2-LoginPort \u0026lt;!-- @pa-port: LoginPort --\u0026gt; Add comment marker to code:\n1 2 3 4 5 6 // LoginPort.kt // @pa-doc: auth.L2-LoginPort interface LoginPort { suspend fun login(request: LoginRequest): LoginResult } Next Steps# Using with Claude Advanced Features "},{"id":12,"href":"/en/docs/pa-layer/frontend/","title":"Frontend Conventions","section":"PA-Layer","content":"Frontend Conventions# PA-Layer Frontend implementation guide.\nBased on React.js, TypeScript, Zustand, and Ky.\nDirectory Structure# src/ â”œâ”€â”€ ports/ # Port definitions â”‚ â”œâ”€â”€ auth/ â”‚ â”‚ â”œâ”€â”€ AuthPort.ts # Interface definition â”‚ â”‚ â”œâ”€â”€ AuthAdapter.ts # HTTP implementation â”‚ â”‚ â””â”€â”€ types.ts # Type definitions â”‚ â””â”€â”€ users/ â”œâ”€â”€ stores/ # Zustand stores â”‚ â”œâ”€â”€ authStore.ts â”‚ â””â”€â”€ userStore.ts â”œâ”€â”€ hooks/ # Custom Hooks â”‚ â”œâ”€â”€ useAuth.ts â”‚ â””â”€â”€ useUser.ts â”œâ”€â”€ components/ # UI components â””â”€â”€ lib/ # Utilities â””â”€â”€ http.ts # HTTP client (Ky)HTTP Client (Ky)# lib/http.ts# 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 import ky from \u0026#39;ky\u0026#39;; const API_BASE_URL = import.meta.env.VITE_API_URL || \u0026#39;http://localhost:8080\u0026#39;; export const http = ky.create({ prefixUrl: API_BASE_URL, timeout: 30000, hooks: { beforeRequest: [ (request) =\u0026gt; { const token = localStorage.getItem(\u0026#39;accessToken\u0026#39;); if (token) { request.headers.set(\u0026#39;Authorization\u0026#39;, `Bearer ${token}`); } } ] } }); Port Definition# ports/auth/types.ts# 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 export interface LoginRequest { email: string; password: string; } export interface LoginResponse { accessToken: string; refreshToken: string; expiresIn: number; user: UserInfo; } // Result type (Discriminated Union) export type LoginResult = | { type: \u0026#39;success\u0026#39;; data: LoginResponse } | { type: \u0026#39;invalidCredentials\u0026#39; } | { type: \u0026#39;accountLocked\u0026#39; } | { type: \u0026#39;networkError\u0026#39;; message: string }; ports/auth/AuthPort.ts# 1 2 3 4 5 6 7 import { LoginRequest, LoginResult } from \u0026#39;./types\u0026#39;; export interface AuthPort { login(request: LoginRequest): Promise\u0026lt;LoginResult\u0026gt;; logout(): Promise\u0026lt;void\u0026gt;; isAuthenticated(): boolean; } ports/auth/AuthAdapter.ts# 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 import { http } from \u0026#39;@/lib/http\u0026#39;; import { AuthPort } from \u0026#39;./AuthPort\u0026#39;; import { LoginRequest, LoginResult } from \u0026#39;./types\u0026#39;; export class AuthAdapter implements AuthPort { async login(request: LoginRequest): Promise\u0026lt;LoginResult\u0026gt; { try { const response = await http.post(\u0026#39;api/auth/login\u0026#39;, { json: request }).json\u0026lt;LoginResponse\u0026gt;(); localStorage.setItem(\u0026#39;accessToken\u0026#39;, response.accessToken); localStorage.setItem(\u0026#39;refreshToken\u0026#39;, response.refreshToken); return { type: \u0026#39;success\u0026#39;, data: response }; } catch (error: any) { if (error.response?.status === 401) { return { type: \u0026#39;invalidCredentials\u0026#39; }; } return { type: \u0026#39;networkError\u0026#39;, message: error.message }; } } async logout(): Promise\u0026lt;void\u0026gt; { localStorage.removeItem(\u0026#39;accessToken\u0026#39;); localStorage.removeItem(\u0026#39;refreshToken\u0026#39;); } isAuthenticated(): boolean { return !!localStorage.getItem(\u0026#39;accessToken\u0026#39;); } } export const authAdapter = new AuthAdapter(); Zustand Store# stores/authStore.ts# 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 import { create } from \u0026#39;zustand\u0026#39;; import { authAdapter } from \u0026#39;@/ports/auth/AuthAdapter\u0026#39;; import { LoginRequest, UserInfo, LoginResult } from \u0026#39;@/ports/auth/types\u0026#39;; interface AuthState { user: UserInfo | null; isLoading: boolean; error: string | null; isAuthenticated: boolean; login: (request: LoginRequest) =\u0026gt; Promise\u0026lt;LoginResult\u0026gt;; logout: () =\u0026gt; Promise\u0026lt;void\u0026gt;; clearError: () =\u0026gt; void; } export const useAuthStore = create\u0026lt;AuthState\u0026gt;((set) =\u0026gt; ({ user: null, isLoading: false, error: null, isAuthenticated: authAdapter.isAuthenticated(), login: async (request: LoginRequest) =\u0026gt; { set({ isLoading: true, error: null }); const result = await authAdapter.login(request); switch (result.type) { case \u0026#39;success\u0026#39;: set({ user: result.data.user, isAuthenticated: true, isLoading: false }); break; case \u0026#39;invalidCredentials\u0026#39;: set({ error: \u0026#39;Invalid email or password.\u0026#39;, isLoading: false }); break; case \u0026#39;networkError\u0026#39;: set({ error: `Network error: ${result.message}`, isLoading: false }); break; } return result; }, logout: async () =\u0026gt; { await authAdapter.logout(); set({ user: null, isAuthenticated: false, error: null }); }, clearError: () =\u0026gt; set({ error: null }) })); Custom Hooks# hooks/useAuth.ts# 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 import { useAuthStore } from \u0026#39;@/stores/authStore\u0026#39;; import { useEffect } from \u0026#39;react\u0026#39;; export function useAuth() { const { user, isLoading, error, isAuthenticated, login, logout, clearError } = useAuthStore(); return { user, isLoading, error, isAuthenticated, login, logout, clearError }; } Components# components/auth/LoginForm.tsx# 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 import { useState, FormEvent } from \u0026#39;react\u0026#39;; import { useAuth } from \u0026#39;@/hooks/useAuth\u0026#39;; import { useNavigate } from \u0026#39;react-router-dom\u0026#39;; export function LoginForm() { const { login, isLoading, error, clearError } = useAuth(); const navigate = useNavigate(); const [email, setEmail] = useState(\u0026#39;\u0026#39;); const [password, setPassword] = useState(\u0026#39;\u0026#39;); const handleSubmit = async (e: FormEvent) =\u0026gt; { e.preventDefault(); clearError(); const result = await login({ email, password }); if (result.type === \u0026#39;success\u0026#39;) { navigate(\u0026#39;/dashboard\u0026#39;); } }; return ( \u0026lt;form onSubmit={handleSubmit} className=\u0026#34;space-y-4\u0026#34;\u0026gt; {error \u0026amp;\u0026amp; ( \u0026lt;div className=\u0026#34;p-3 bg-red-100 text-red-700 rounded\u0026#34;\u0026gt; {error} \u0026lt;/div\u0026gt; )} \u0026lt;div\u0026gt; \u0026lt;label htmlFor=\u0026#34;email\u0026#34;\u0026gt;Email\u0026lt;/label\u0026gt; \u0026lt;input type=\u0026#34;email\u0026#34; id=\u0026#34;email\u0026#34; value={email} onChange={(e) =\u0026gt; setEmail(e.target.value)} required disabled={isLoading} /\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div\u0026gt; \u0026lt;label htmlFor=\u0026#34;password\u0026#34;\u0026gt;Password\u0026lt;/label\u0026gt; \u0026lt;input type=\u0026#34;password\u0026#34; id=\u0026#34;password\u0026#34; value={password} onChange={(e) =\u0026gt; setPassword(e.target.value)} required disabled={isLoading} /\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;button type=\u0026#34;submit\u0026#34; disabled={isLoading}\u0026gt; {isLoading ? \u0026#39;Signing in...\u0026#39; : \u0026#39;Sign In\u0026#39;} \u0026lt;/button\u0026gt; \u0026lt;/form\u0026gt; ); } Architecture Summary# â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ Component â”‚ â† UI Rendering â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ Custom Hook â”‚ â† Business Logic Abstraction â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ Zustand Store â”‚ â† State Management â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ Adapter â”‚ â† HTTP Implementation â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ Port â”‚ â† Interface Definition â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜Benefits# Aspect Description Testability Replace Port with Mock for unit testing Consistency Same interface as Backend Port Maintainability HTTP implementation encapsulated in Adapter State Management Simple global state with Zustand "},{"id":13,"href":"/en/docs/installation/linux/","title":"Linux Installation","section":"Installation","content":"Linux Installation Guide# Set up the PA-Layer environment on Ubuntu, Debian, Fedora, and other Linux distributions.\n1. Install with Script (Recommended)# 1 2 3 4 5 # Run install script curl -sSL https://pa-layer.github.io/install.sh | bash # Verify installation pa version 2. Manual Installation# x64 (amd64)# 1 2 3 4 5 6 7 8 9 10 11 12 13 # Download curl -LO https://github.com/pa-layer/pa-retriever/releases/latest/download/pa-retriever-linux-amd64.tar.gz # Extract tar xzf pa-retriever-linux-amd64.tar.gz # Install chmod +x pa sudo mv pa /usr/local/bin/ # Or install to user directory mkdir -p ~/.local/bin mv pa ~/.local/bin/ ARM64 (aarch64)# 1 2 3 4 5 6 7 # Download curl -LO https://github.com/pa-layer/pa-retriever/releases/latest/download/pa-retriever-linux-arm64.tar.gz # Extract and install tar xzf pa-retriever-linux-arm64.tar.gz chmod +x pa sudo mv pa /usr/local/bin/ 3. Shell Configuration# Bash (~/.bashrc)# 1 2 3 4 5 6 7 8 9 # PA-Layer environment variables export PA_HOME=\u0026#34;$HOME/.pa\u0026#34; export PA_WORKSPACE=\u0026#34;$HOME/playground\u0026#34; export PATH=\u0026#34;$HOME/.local/bin:$PATH\u0026#34; # Aliases alias pas=\u0026#34;pa search\u0026#34; alias pai=\u0026#34;pa index\u0026#34; alias pac=\u0026#34;pa code\u0026#34; Zsh (~/.zshrc)# 1 2 3 4 5 6 7 8 9 # PA-Layer environment variables export PA_HOME=\u0026#34;$HOME/.pa\u0026#34; export PA_WORKSPACE=\u0026#34;$HOME/playground\u0026#34; export PATH=\u0026#34;$HOME/.local/bin:$PATH\u0026#34; # Aliases alias pas=\u0026#34;pa search\u0026#34; alias pai=\u0026#34;pa index\u0026#34; alias pac=\u0026#34;pa code\u0026#34; 4. Initialize# 1 2 3 4 5 # Interactive initialization pa init # Quick initialization pa init --yes Next Steps# Workspace Setup Configuration "},{"id":14,"href":"/en/docs/pa-layer/","title":"PA-Layer","section":"Documentation","content":"PA-Layer# A software architecture convention for working with AI agents.\nWhat is PA-Layer?# PA-Layer is a practical architecture convention combining Port/Adapter (Hexagonal) architecture with CQS (Command-Query Separation) patterns.\nPA-Layer = Port/Adapter + CQS + AI-Friendly ConventionWhy PA-Layer?# 1. AI Agent Friendly# Feature Description Clear boundaries Responsibilities separated by Port units for easy context understanding Standardized documents Consistent format for AI pattern learning and prediction Selective loading Load only needed documents to maximize token efficiency 2. Token Efficient# Aspect Traditional RAG PA-Layer Search method Vector similarity Structured query Result format Document chunks Complete documents Context Partial Fully preserved Dependency tracking Not possible Tracked via Wiki links 3. Proven Architecture# Hexagonal Architecture: Separation of business logic and infrastructure CQS Pattern: Clear separation of commands and queries Layer Structure: Enforced dependency direction L1 â†’ LM â†’ L2 Sections# Architecture Overview Backend Conventions Frontend Conventions "},{"id":15,"href":"/en/docs/configuration/pa-config/","title":"PA-Retriever Config","section":"Configuration","content":"PA-Retriever Config# Detailed configuration for PA-Retriever\u0026rsquo;s config.yaml file.\nConfig File Location# 1 2 3 4 5 6 7 8 9 10 11 # Default location ~/.pa/config.yaml # Check path pa config path # View current config pa config show # Edit with editor pa config edit Full Configuration Structure# 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 # ~/.pa/config.yaml # Active profile active: default # Workspace settings workspace: root: ~/playground obsidian_vault: ~/playground/mcp-docs code_space: ~/playground/CodeSpace # Index settings index: db_path: ~/.pa/default.db wal_mode: true exclude: - \u0026#34;*.tmp\u0026#34; - \u0026#34;.git\u0026#34; - \u0026#34;node_modules\u0026#34; - \u0026#34;.obsidian/workspace*.json\u0026#34; # Document type settings types: preset: agile # basic, agile, design, full # Profile list profiles: - name: default db_path: ~/.pa/default.db docs_path: ~/playground/mcp-docs description: \u0026#34;Default profile\u0026#34; # MCP server settings mcp: servers: - name: claude-desktop enabled: true - name: claude-code enabled: true Section Details# workspace# 1 2 3 4 workspace: root: ~/playground # Workspace root obsidian_vault: ~/playground/mcp-docs # Obsidian Vault path code_space: ~/playground/CodeSpace # Code projects root index# 1 2 3 4 5 6 7 index: db_path: ~/.pa/default.db # SQLite database path wal_mode: true # WAL mode (recommended) exclude: # Exclude patterns - \u0026#34;*.tmp\u0026#34; - \u0026#34;.git\u0026#34; - \u0026#34;node_modules\u0026#34; types# 1 2 3 4 5 6 7 8 9 10 11 12 types: # Preset selection # basic: l1, lm, l2, api, query, feature, template, skill, guide # agile: basic + epic, story, task, bug, spike # design: basic + adr, rfc, spec, diagram # full: all types preset: agile # Custom types custom: - name: memo description: \u0026#34;Short memos\u0026#34; profiles# 1 2 3 4 5 6 7 8 9 10 profiles: - name: default db_path: ~/.pa/default.db docs_path: ~/playground/mcp-docs description: \u0026#34;Personal projects\u0026#34; - name: work db_path: ~/.pa/work.db docs_path: ~/work/docs description: \u0026#34;Work projects\u0026#34; CLI Config Commands# Profile Management# 1 2 3 4 5 6 7 8 9 10 11 12 # List profiles pa profile list # Add profile pa profile add work --db=~/.pa/work.db --docs=~/work/docs # Switch profile pa use work pa use default # Current status pa status Check Settings# 1 2 3 4 5 6 7 8 # Full config pa config show # Active types pa config types # Config file path pa config path Environment Variables# 1 2 3 4 5 6 7 8 9 10 11 # Config directory export PA_HOME=~/.pa # Workspace root export PA_WORKSPACE=~/playground # Profile selection export PA_PROFILE=work # Example: run with different profile PA_PROFILE=work pa search \u0026#34;type:l2\u0026#34; Next Steps# PA-Layer Architecture PA-Retriever Usage "},{"id":16,"href":"/en/docs/pa-retriever/","title":"PA-Retriever","section":"Documentation","content":"PA-Retriever# A CLI tool for indexing and searching PA-Layer documents.\nOverview# PA-Retriever provides the following features:\nDocument Indexing: Parse markdown documents and store in SQLite Advanced Search: Support for AND/OR/NOT queries MCP Server: Real-time integration with Claude Code Indexing: Extract code signatures and connect to documents Bundle Sharing: Document packaging and distribution Sections# Basic Usage Search Guide Code Indexing Using with Claude Advanced Features "},{"id":17,"href":"/en/docs/pa-retriever/with-claude/","title":"Using with Claude","section":"PA-Retriever","content":"Using with Claude# How to use PA-Retriever with Claude Desktop and Claude Code.\nMCP Connection Setup# 1 2 3 4 5 # Auto setup pa mcp install # Check status pa mcp status Restart Claude Desktop after setup.\nBasic Conversation Commands# Search Documents# User: Find all L2 Ports in the auth domain Claude: [search_docs call] Found the following L2 Ports in auth domain: 1. L2-LoginPort - Login process 2. L2-SignupPort - Signup process 3. L2-PasswordResetPort - Password resetGet Document# User: Show me the full L2-LoginPort document Claude: [get_doc call] # L2-LoginPort ## Overview L2 Port that handles login process. ## Interface ...Find Port# User: Find the spec and implementation for LoginPort Claude: [find_port call] Found LoginPort: ğŸ“„ Document: auth.L2-LoginPort ğŸ’» Code: - my-backend/src/.../LoginPort.kt (interface) - my-backend/src/.../LoginAdapter.kt (class) Practical Scenarios# Scenario 1: Write New Document# User: Create an L2-CheckoutPort document for the payment domain. Reference the existing L2 document format. Claude: Let me check the existing L2 document format first. [search_docs type:l2 limit:2] Based on existing documents, here\u0026#39;s the new document: --- type: l2 domain: payment status: draft depends_on: [L1-PaymentPort, L1-CartPort] --- # L2-CheckoutPort ...Scenario 2: Generate Code# User: Create a Kotlin implementation based on L2-LoginPort spec Claude: Let me check the L2-LoginPort spec first. [get_doc id:auth.L2-LoginPort] Let me also check dependencies. [get_doc id:auth.L1-UserPort] [get_doc id:auth.L1-TokenPort] Based on the spec, here\u0026#39;s the implementation: @Component class LoginAdapter( private val userPort: UserPort, private val tokenPort: TokenPort ) : LoginPort { ... }Scenario 3: Architecture Review# User: Analyze the current auth domain architecture Claude: Let me analyze the auth domain documents. [search_docs domain:auth] ## Auth Domain Architecture Analysis ### Layer Structure API Layer â””â”€â”€ API-Login, API-Signup L2 (Feature) â””â”€â”€ L2-LoginPort, L2-SignupPort L1 (Domain) â””â”€â”€ L1-UserPort, L1-TokenPort ### Dependencies - L2-LoginPort â†’ L1-UserPort, L1-TokenPort ... Tips# Efficient Conversations# Be specific: \u0026ldquo;show document\u0026rdquo; â†’ \u0026ldquo;show L2-LoginPort document in auth domain\u0026rdquo; Provide context: \u0026ldquo;create new document\u0026rdquo; â†’ \u0026ldquo;create PaymentPort document in L2 format\u0026rdquo; Step by step: Break complex tasks into multiple requests Explicit Tool Calls# You can ask Claude to use specific tools:\nUser: Use search_docs to search for type:api documents User: Use get_architecture to show PA-Layer rules User: Use find_port to find LoginPort Next Steps# Advanced Features "},{"id":18,"href":"/en/docs/installation/workspace/","title":"Workspace Setup","section":"Installation","content":"Workspace Setup# Directory structure for efficient work with PA-Layer system.\nRecommended Structure# ~/playground/ # Workspace root â”œâ”€â”€ mcp-docs/ # ObsidianVault (documents) â”‚ â”œâ”€â”€ .obsidian/ # Obsidian settings â”‚ â”œâ”€â”€ ports/ # Port documents â”‚ â”‚ â”œâ”€â”€ auth/ â”‚ â”‚ â”‚ â”œâ”€â”€ L1-AuthPort.md â”‚ â”‚ â”‚ â”œâ”€â”€ L2-LoginPort.md â”‚ â”‚ â”‚ â””â”€â”€ L2-SignupPort.md â”‚ â”‚ â””â”€â”€ users/ â”‚ â”‚ â””â”€â”€ L2-ProfilePort.md â”‚ â”œâ”€â”€ templates/ # Templates â”‚ â”œâ”€â”€ guides/ # Guides â”‚ â””â”€â”€ .pa-index.yaml # Index settings â”‚ â”œâ”€â”€ CodeSpace/ # Code projects â”‚ â”œâ”€â”€ my-backend/ # Kotlin/Spring project â”‚ â”œâ”€â”€ my-frontend/ # React project â”‚ â””â”€â”€ my-api/ # Go API project â”‚ â””â”€â”€ bundles/ # Shared Bundle storage ~/.pa/ # PA-Retriever settings â”œâ”€â”€ config.yaml # Main config â”œâ”€â”€ default.db # Index database â”œâ”€â”€ keys/ # Signing keys â””â”€â”€ peers.json # LAN peer cacheBenefits# 1. AI Agent Collaboration# Clear context: AI knows which documents/code to reference Token efficiency: Load only needed documents Consistent structure: AI can navigate predictable locations 2. Document-Code Connection# 1 2 3 4 5 6 7 8 9 \u0026lt;!-- mcp-docs/ports/auth/L2-LoginPort.md --\u0026gt; --- type: l2 domain: auth port_id: LoginPort --- # L2-LoginPort @pa-port: LoginPort 1 2 3 4 // CodeSpace/my-backend/src/.../port/LoginPort.kt interface LoginPort { fun login(request: LoginRequest): LoginResult } PA-Retriever automatically connects documents and code.\n3. Multi-project Support# 1 2 3 4 5 6 7 # Manage multiple workspaces with profiles pa profile add work --docs=~/work/docs --db=~/.pa/work.db pa profile add personal --docs=~/personal/notes --db=~/.pa/personal.db # Switch profiles pa use work pa use personal Setup Checklist# Create ~/playground directory Create ~/playground/mcp-docs and initialize Git Create ~/playground/CodeSpace Open mcp-docs Vault in Obsidian Run pa init Run pa index Run pa mcp install Restart Claude Desktop Next Steps# Configuration - Detailed Claude, Obsidian setup "},{"id":19,"href":"/en/docs/pa-retriever/advanced/","title":"Advanced Features","section":"PA-Retriever","content":"Advanced Features# Advanced features of PA-Retriever.\nBundle Management# Create Bundle (Export)# Package documents into shareable .pab files.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 # Bundle by domain pa export --domain=auth --name=\u0026#34;auth-module\u0026#34; # Bundle by type pa export --type=l2 --name=\u0026#34;l2-ports\u0026#34; # Select specific documents pa export --ids=\u0026#34;auth.L2-LoginPort,auth.L2-SignupPort\u0026#34; --name=\u0026#34;auth-login\u0026#34; # Include dependencies pa export --domain=auth --include-deps --name=\u0026#34;auth-full\u0026#34; # With signature pa export --domain=auth --sign --name=\u0026#34;auth-signed\u0026#34; Import Bundle# 1 2 3 4 5 6 7 8 9 10 11 # Basic import pa import auth-module.pab # Skip on conflict pa import auth-module.pab --strategy=skip # Overwrite on conflict pa import auth-module.pab --strategy=overwrite # Verify signature pa import auth-module.pab --verify Bundle Info# 1 pa info auth-module.pab LAN Sharing# Start Share Server# 1 2 3 4 5 6 7 8 # Basic start pa share start # With name and port pa share start --name=\u0026#34;My-Mac\u0026#34; --port=9000 # With token auth pa share start --token=\u0026#34;my-secret-token\u0026#34; Discover Peers# 1 2 3 4 5 # Search network for PA-Retriever pa discover # With timeout pa discover --timeout=10s Download Bundle# 1 2 3 4 5 6 7 8 # Download specific bundle pa fetch Alice-Mac/auth-module # Browse peer\u0026#39;s bundles pa lan browse Alice-Mac # Search across peers pa lan search \u0026#34;auth\u0026#34; Registry (Local/Git)# Create Local Registry# 1 2 3 4 5 # Initialize registry pa registry init # With name pa registry init --name=\u0026#34;my-registry\u0026#34; --path=~/my-registry Publish Bundle# 1 2 # Publish to local registry pa publish auth-module.pab --version=1.0.0 Search Registry# 1 2 3 4 5 # Search in registry pa registry search \u0026#34;auth\u0026#34; # List bundles pa registry list Download from Registry# 1 2 3 4 5 # Download from registry pa registry fetch auth-module # Specific version pa registry fetch auth-module@1.0.0 Signing (Identity)# Generate Keys# 1 2 3 4 5 # Generate signing key pair pa identity generate # With name pa identity generate --name=work List Keys# 1 pa identity list Sign Bundle# 1 2 3 4 5 # Sign with default key pa export --domain=auth --sign --name=\u0026#34;auth-signed\u0026#34; # Sign with specific key pa export --domain=auth --sign --key=work --name=\u0026#34;auth-signed\u0026#34; Verify Signature# 1 2 # Verify on import pa import auth-signed.pab --verify Profile Management# Create Profile# 1 2 3 4 5 # Work profile pa profile add work --db=~/.pa/work.db --docs=~/work/docs --desc=\u0026#34;Work projects\u0026#34; # Team profile pa profile add team --db=~/.pa/team.db --docs=~/shared/team/docs Switch Profile# 1 2 3 4 5 # Switch pa use work # Check current pa status --compact Temporary Switch with Env# 1 PA_PROFILE=work pa search \u0026#34;type:l2\u0026#34; HTTP API Server# Access via HTTP API in addition to MCP.\n1 2 # Start HTTP server pa serve --http --port=8080 API Endpoints# Endpoint Method Description /api/search GET Search documents /api/docs/{id} GET Get document /api/stats GET Statistics Examples# 1 2 3 4 5 # Search curl \u0026#34;http://localhost:8080/api/search?q=type:l2\u0026#34; # Get document curl \u0026#34;http://localhost:8080/api/docs/auth.L2-LoginPort\u0026#34; Automation# Cron Indexing# 1 2 3 4 5 6 7 8 # Edit crontab crontab -e # Hourly indexing 0 * * * * /usr/local/bin/pa index \u0026gt;\u0026gt; ~/.pa/index.log 2\u0026gt;\u0026amp;1 # Daily full re-index 0 3 * * * /usr/local/bin/pa index --force \u0026gt;\u0026gt; ~/.pa/index.log 2\u0026gt;\u0026amp;1 Git Hook# 1 2 3 # .git/hooks/post-commit #!/bin/bash pa index Troubleshooting# Index Corruption# 1 2 3 # Recreate index rm ~/.pa/default.db* pa index --force MCP Connection Issues# 1 2 3 4 5 # Check logs pa serve --mcp --verbose # Regenerate config pa mcp install --force Search Result Issues# 1 2 # Rebuild FTS index pa index --rebuild-fts "}]